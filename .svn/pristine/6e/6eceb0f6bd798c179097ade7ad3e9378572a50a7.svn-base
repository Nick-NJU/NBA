package utility;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Properties;


public class DataBaseUtility {
	private String userName;
	private String password;
	private String dbms;
	private String serverName;
	private int portNumber;
	public DataBaseUtility(String userName, String password, String dbms,
			String serverName, int portNumber) {
		super();
		this.userName = userName;
		this.password = password;
		this.dbms = dbms;
		this.serverName = serverName;
		this.portNumber = portNumber;
	}
	
	public boolean initial(){
		
		return true;
	}
	
	public Connection getConnection() throws SQLException {
	    Connection conn = null;
	    Properties connectionProps = new Properties();
	    connectionProps.put("user", this.userName);
	    connectionProps.put("password", this.password);
	    
	    conn = DriverManager.getConnection(
                "jdbc:" + this.dbms + "://" +
                this.serverName +
                ":" + this.portNumber + "/",
                connectionProps);
	    System.out.println("Connected to database");
	    return conn;
	}

	public void createTable() throws SQLException {
	    String createString =
	        "create table " +
	        "TEAMS " +
	        "(NAME varchar(20) NOT NULL, " +
	        "FOUNDED varchar(4) NOT NULL, " +
	        "ABBV varchar(6) NOT NULL, " +
	        "CITY varchar(20) NOT NULL, " +
	        "DIVISION varchar(8) NOT NULL, " +
	        "ARENA varchar(10), " +
	        "PRIMARY KEY (NAME))";

	    Statement stmt = null;
	    try {
	        stmt = con.createStatement();
	        stmt.executeUpdate(createString);
	    } catch (SQLException e) {
	        JDBCTutorialUtilities.printSQLException(e);
	    } finally {
	        if (stmt != null) { stmt.close(); }
	    }
	}
}